=========
Changelog
=========


1.17.11 - 2018-07-13
-------------------

* исправлена ошибка в зависимостях


1.17.10 - 2018-07-13
-------------------

* менеджеру по заявкам данны те же права, что и у staff'ов за исключение прав на партнерство и контроль доступа


1.17.9 - 2018-07-13
-------------------

* добалено ограничение на количество запросов на отправку sms с подтверждением для light_auth.
  Разрешена отправка 1 sms в минуту от одного менеджера для одного пользователя.


1.17.8 - 2018-07-12
-------------------

* добалено /api/vo/hierarchies/ для разработчиков vochurch.online


1.17.7 - 2018-07-12
-------------------

* добалено post метод для /api/proposal/ и /api/event_proposal/


1.17.6 - 2018-07-12
-------------------

* Hotfix


1.17.5 - 2018-07-12
-------------------

* При логине light_auth отдаются данные по пользователю


1.17.3-4 - 2018-07-11
-------------------

* Hotfix


1.17.2 - 2018-07-11
-------------------

* Уменьшен штрихкод на билетам саммита


1.17.1 - 2018-07-11
-------------------

* Добавлена проверка ключа пользователя vochurch.online


1.17.0 - 2018-07-11
-------------------

* Блок интересы в заявках пользователей перенесен
* Добавлена возможность создания и работы с аккаунтом пользователя для vochurch.online


1.16.3 - 2018-07-10
-------------------

* Изменен дизайн билетов на саммит


1.16.2 - 2018-07-08
-------------------

* Добавлена выгразка битетов саммита по фильтру


1.16.1 - 2018-07-05
-------------------

* Добавлена документация для api по пользователю для разработчиков vochurch.online


1.16.0 - 2018-07-04
-------------------

* Добавлено поле `language` (язык) для пользователя
* Добавлена новая иерархия `lead` (Лид)
* Добавлены мессенджеры для пользователей (backend)
* Добавлена api для получения информации о пользователе по id для разработчиков vochurch.online
* Добавлена api для получения информации о ответственном пользователя по id для разработчиков vochurch.online
* Добавлена api для изменения информации о пользователе по id для разработчиков vochurch.online
* Для заявок добавлен фильтр по статусу (backend)
* Добавлены заявки на мероприятие


1.15.4 - 2018-06-30
-------------------

* Исправлена ошибка в количестве ненапечатанных билетов


1.15.3 - 2018-06-30
-------------------

* Изменен дизайн билетов на саммит


1.15.2 - 2018-06-30
-------------------

* Добавлен вывод интересов на фронденд в заявках на создание пользователя


1.14.10-1.15.1 - 2018-06-23 - 2018-06-27
----------------------------------------

* Работа по проходам на саммит и билетам


1.14.9 - 2018-06-22
-------------------

* Добавлено /api/app/users/clean_code/?code=XXXXXXX


1.14.8 - 2018-06-21
-------------------

* Для таблицы по анкетам саммита добавлено фильтр для поиска по номеру електронного билета
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/43>`_

1.14.7 - 2018-06-19
-------------------

* в админ панели добавлено возможность назначеть менеджеров по заявкам
* фронтенд по заявкам приведен в соответствие к бекенду:

  - добавлено поле `country`
  - добавлено поле `city`
  - добавлено поле `leader_name`
  - добавлено поле `age_group`
  - добавлено поле `gender_group`
  - добавлено поле `geo_location`
  - удалено поле `locality`

1.14.6 - 2018-06-16
-------------------

* в модель `Proposal` добавлено поле `raw_data` для записи запроса который приходит
  от разработчиков vo.org.ua
* для разработчиков vo.org.ua добавлен endpoint `/api/proposal/`, который отдает
  все заявки на добавление пользователя


1.14.4 - 2018-06-14
-------------------

* в раздел "ОТЧЕТЫ / ДОМАШНИЕ ГРУППЫ" добавлено поле 'неизвестно' для прихожан и новообращенных


1.14.3 - 2018-06-14
-------------------

* добавлено поля `title_en`, `title_de`, `title_ru` для Направлений


1.14.2 - 2018-06-14
-------------------

* для разработчиков vo.org.ua добавлено поля `city`, `country` в заявку на создание пользователя.


1.14.1 - 2018-06-14
-------------------

* исправлена ошибка в миграциях базы данных


1.14.0 - 2018-06-14
-------------------

* в таблицу посетителей встреч домашних групп добавленны новые поля
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/40>`_

  - is_stable (стабильный/нестабильный)
  - master (ответственный)
  - home_group (домашняя группа)
  - church (церковь)

* поля из предыдущего пункта автоматически заполняются при создании записи о посещении
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/41>`_
* для построения статистики о стабильности посетителей встреч домашних групп информация берется из записи о
  соответствующем посещении, а не с таблицы пользователя как было раньше. В связи с этим информация
  о стабильности посетителей со всех предшедствующих записях о посещениях значится как неизвестно
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/42>`_


1.13.5 - 2018-06-13
-------------------

* для ускорения запроса плана по менеджерам добавлено кеширования результатов, кеш по текущему
  месяцу обновляется каждый час, а по оставльным менеджерам раз в день в 6:00 по Киеву


1.13.4 - 2018-06-12
-------------------

* ускорен запрос на страницы /admin/group/church/<pk>/
* ускорен запрос на страницы /admin/group/homegroup/<pk>/

1.13.3 - 2018-06-12
-------------------

* ускорен запрос на страницы /admin/lesson/videolesson/


1.13.2 - 2018-06-12
-------------------

* ускорен запрос на получение домашних групп для разработчиков vo.org.ua


1.13.1 - 2018-06-11
-------------------

* fix token


1.13.0 - 2018-06-11
-------------------

* поправлен раздел справки
* добавлен api для разработчиков vo.org.ua

  - список отделов
  - список интересов в группах
  - создание заявок на добавление пользователя
  - поиск городов


1.12.6 - 2018-06-08
-------------------

* в таблице отчетов домашних групп добавлена сортировка по количеству новых, гостей и покаяний


1.12.4 - 2018-06-08
-------------------

* исправлены права на вход


1.12.3 - 2018-06-07
-------------------

* celery обновлен до версии 4
* количество worker'ов увеличено до core*2+1


1.12.2 - 2018-06-07
-------------------

* исправлено /api/app/summits/<id>/request_count/
* добавлено поле CustomUser.is_proposal_manager управляющее правом на работу с лидами на добавление пользователей
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/31>`_


1.12.1 - 2018-06-05
-------------------

* Исправлен баг с зависанием при долгом ответе от asterisk
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/34>`_


1.12.0 - 2018-05-31
-------------------

* В отчеты по домашним группам добавлено поле для указания количества новых на собрании,
  для Служений добавлено поле для указания количества покаяний
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/27>`_
* В статистику по домашним группам добавлено  количество новых и количество покаяний
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/28>`_


1.11.2 - 2018-05-25
-------------------

* При сортировке записи с одинаковыми значениями сортируемого поля между собой сортируются по id
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/25>`_


1.11.1 - 2018-05-24
-------------------

* В статистике домашних групп добавлен фильтр по присутствию
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/26>`_


1.11.0 - 2018-05-24
-------------------

* В статистику по домашним группам добавлено финансовую информации и количество гостей
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/22>`_
* В текстовых уроках добавлено возможность добавлять несколько изображений
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/23>`_
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/24>`_


1.10.0 - 2018-05-18
-------------------

* Для платежей по саммитам добавлено указание валюты платежа
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/21>`_
* Добавлена возможность загрузки и конвертации видео для видеоуроков
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/19>`_
* В отчеты по домашним группам добавлено поле для указания количества гостей на собрании
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/20>`_


1.9.0 - 2018-05-08
------------------

* Не подавать отчеты домашних групп типа "Домашняя" если сумма пожертвований равна нулю
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/18>`_
* Добавлено вывод на карту церквей
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/3>`_
* Добавлено вывод на карту домашних групп
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/4>`_
* Добавлено печать карты с церквями
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/5>`_
* Добавлено печать карты с домашними группами
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/6>`_


1.8.23 - 2018-05-05
-------------------

* Добавлено версионирование `issue <https://gitlab.sobsam.com/web/vocrm/issues/17>`_
* Добавлена документация разработчика для доступа через сайт


1.8.22 - 2018-05-05
-------------------

* Исправлена ошибка фильтра уроков по уровню доступа


1.8.21 - 2018-05-04
-------------------

* Добавлена возможность задавать несколько авторов для уроков
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/16>`_


1.8.20 - 2018-05-03
-------------------

* Добавлен API для лайка уроков
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/15>`_
* Добавлено разделение уроков для лидеров/пасторов
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/13>`_


1.8.19 - 2018-05-02
-------------------

* Добавлен API для получения координат церквей, для вывода их на карту
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/1>`_
* Добавлен API для получения координат домашних групп, для вывода их на карту
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/2>`_


1.8.18 - 2018-05-02
-------------------

* Добавлен статус "Голд" в разделе партнерства `issue <https://gitlab.sobsam.com/web/vocrm/issues/12>`_


1.8.17 - 2018-04-27
-------------------

* Добавлена колонка "Людей в домашних группах" в таблице церквей
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/10>`_
* По умолчанию в таблице церквей показываются только открытые церкви.
  `issue <https://gitlab.sobsam.com/web/vocrm/issues/11>`_


1.8.16 - 2018-04-26
-------------------

* Добавлено фильтр по оплатам в саммите `issue <https://gitlab.sobsam.com/web/vocrm/issues/8>`_


1.8.15 - 2018-04-26
-------------------

* Исправлена ошибка подачи отчета по домашней группе `issue <https://gitlab.sobsam.com/web/vocrm/issues/7>`_


1.8.14 - 2018-04-26
-------------------

* В статистику по членам домашних групп добавлены графики


1.8.13 - 2018-04-23
-------------------

* Для партнерства добавлен новый статус "Рубиновый"
* Обновлен фильтр по vip статусу в партнерстве


1.8.12 - 2018-04-23
-------------------

* Добавлена статистика по членам домашних групп
* Добавлен фильтр по vip статусу в партнерстве


1.8.11 - 2018-04-20
-------------------

* При трех подряд посещениях/не посешениях домашних групп пользователь помечается стабильным/не стабильным


1.8.10 - 2018-04-18
-------------------

* Вместо code отдается reg_code для api/summit_attends/check_and_send_college_code/


1.8.9 - 2018-04-17
------------------

* Добавлено таски trainee_group_members_deactivate и vip_partners_group_members_deactivate для ботов
* Для /api/app/users/get_tickets/ добавлено поле title
* Отключено автосоздание отчета по Марафону при создании новой Домашней Группы


1.8.8 - 2018-04-17
------------------

* Исправлена ошибка когда request.data была dict'ом


1.8.7 - 2018-04-16
------------------

* Для BotGroup добавлено поле bot_address


1.8.6 - 2018-04-16
------------------

* Удалено логирование в файл


1.8.5 - 2018-04-15
------------------

* Исправлено логирование не авторизированого пользователя


1.8.4 - 2018-04-15
------------------

* Исправлено логирование не авторизированого пользователя
* Исправлено img/no-usr.jpg


1.8.3 - 2018-04-14
------------------

* Добавлен деплой в Gitlab CI


1.8.2 - 2018-04-13
------------------

* Отменено формирования отчетов по Домащним группам night
* Добавлено Gitlab CI
* Рефакторинг
* Добавлено поле "Пол" для пользователей
* На фронденде реализовано возможность указывать Пол при создании пользователя
* Добавлено поле "code" в иерархии
* На бекенде добавлено обязательное заполнение "Даты покаяния" для создания/изменения пользователя
  с иерархией "Новообращенный"
* Через 6 месяцев после даты покаяния пользователь с иерархией Новообращенный автоматически повышается до Прихожанин


1.8.1 - 2018-04-05
------------------

* Рефакторинг


1.8 - 2018-04-04
----------------

* Перешли на Django 2.0
* Перешли на Webpack 4
* Отказ от dbmail, grappelli и django-celery
* Export выполняется асинхронно
* Добавлено логирование изменение партнеров
* Сайт переведен на https
* Изменена база данных городов
* Добавлено мультипартнерство
* Добавлены планы для менеджеров по партнерству
* Добавлено Партнерские группы
* Добавлено Роли партнеров
* Статика и изображения переведены на aws
* Добавлена возможность назначать менеджеров (скины)
* Добавлена кастомная админка
* Хранение столбцов таблиц для пользователей перенесено на redis
* Добавлен поиск дубликатов сделок
* Добавлены партнерста, сделки и платежи церквей
* Сканер билетов и тд вынесены в отдельные сервисы
* Для домашних групп добавлено фото
* Все время переведено на UTC
* Добавлена возможность входа по id, username
* Добавлена статистика по партнерству церквей
* Добавлена статистика по отчетам церквей
* Добавлены звонки
* Добавлено логирование запросов
* Добавлен раздел помощи
* Добавили авторов регистрации в саммиты
* Добалено api для работы с телеграм ботом
* Добавлено возможность выбора города на карте google


1.7 - 2017-09-04
----------------

* Добавлено отслеживание перемещения посетителей саммита
* Добавлено возможность создания событий для саммита
* В раздел саммитов добавлено фильтр по наличию фотографии у пользователя, по присутствию пользователя на саммите
* Добавлено API по посещаемости саммита
* Билеты на саммит создаются только для пользователей у которых есть фото
* Добавлен статус (напечатано/не напечатано) для билетов на саммит
* Добавлено API для мобильного приложения для получения участников саммита в древовидном виде
* Добавлены pdf отчеты по саммиту
* Добавлена статистика по саммиту
* Добавлена графики по посещению саммита
* Для анкеты саммита добавлено статус (активна/неактивна, был ли запрошен регистрационный код)
* Для статуса анкеты саммита добавленно поле с датой когда был запрошен регистрационный код
* Создание пользователя разделено на два этапа (обязательные поля и дополнительные)
* Добавлена проверка возможности смены ответственного и уровням иерархии
* Добавлена проверка на дубликаты при создании нового пользователя
* Введена валидация номера телефона пользователя, он должен содержать не менее 10 цифр
* Добавлена статистика домашних групп
* Добавлено отчеты домашних групп
* Если у партнера 3+ незакрытых просроченных сделки — он помечается неактивным
* В партнерстве добавлена таблица План по менеджерам
* Метод построения дерева пользователей изменен с NS на MP
* Docker теперь самостоятельно получает ssl сертификат для сайта
* Добавлен главный епископ
* Изменен стиль диалоговых окон на сайте
* Добавлена возможность задавать кто имеет право для входа в CRM, а кто нет
* Добавлено логирование изменений/добавлений пользователя, сделок, платежей,
    добавления и удаления пользователя из саммита, измнения церкви и/или домашней группы пользователя
* На главную страницу добавленно дашборд со статистикой по пользовалелю

1.6.1b - 2017-03-24
-------------------

* Дано возможность редактировать всех пользователей которых ты видишь

1.6 - 2017-03-22
----------------

* Добавленно экспорт для таблиц
* Добавлен фильтр ``is_open`` для таблицы церквей
* Добавена домашняя страница
* Добавлен фильтр для таблиц партнерства, церквей, домашних груп, саммитов
* Добавлен выбор валюты для "денежных" полей
* В API добавлены методы для изменения и удаления платежей
* Удалена страница редактирования пользователя
* В анкете пользователя реализовано поблочное редактирование пользователя
* Добавлна валидация на уникальность полей: ``first_name``, ``last_name``, ``middle_name``, ``phone_number``
* В API добавлнен метод на наличие в базе пользователей с определенными ``last_name``,
    ``email``, ``phone_number``
* Допустимая длина поле для основного телефона увеличена с 13 до 23 символов
* Обновлена статистика по партнерам, теперь она считается по платежам
* Для таблицы пользователей добавлен фильтр по дереву ответственного
* Участников саммита могут видеть только "Консультант+" по саммиту
* Добавлена возможность задания для пользователя нескольких Отделов (department)
* Довавлена возможность изменения своего пароля
* Для таблицы домашних групп добавлен фильтр по дереву ответственного
* Добавлена возможность быстрого редактирования для групп
* Добавлено поля примечания для пользователя
* Удалено быстрое редактирования пользователей

1.5 - 2017-02-13
----------------

* Для пользователя добавлено поле Духовный уровень
* Добавлены группы, церкви
* Сделки для неактивных партнеров больше не создаются
* Сделки, партнерства и статистика по партнерам разнесены на отдельные страницы
* Добавлены платежи и валюты
* Изменена логика работы с доп. телефонами пользователя
* Добавлена возможность работы с websocket'ами
* Исправленны баги

1.4.3b - 2017-01-13
-------------------

* Изменено метод для редактирование и создание пользователя, переведено на NewUserViewSet

1.4.1b - 2017-01-12
-------------------

* Добавлено возможность создавать и изменять поле search_user для пользователя.

1.4 - 2017-01-12
----------------

* Добавлены поля code, full_cost и special_cost для Summit
* Добавлено поле code для SummitType
* Админ панель переведена на grappelli
* Создан поиск по имени, email, телефону, стране, городу и фильтр по иерархии, ответственному и отделу на
  странице базы данных
* Добавлено "Быстрое редактирование" в таблице Базы Данных
* В БД добавлено поле "Имя пользователя на родном языке" для поиска по имени
* Отправка email'ов по саммитам переведена на приложение dbmail
* Добавлена документация для разработчиков (начата)
* CustomUser переведен на MPTT
* База данных изменена с mysql на postgres
* Для разработки добавлен django-debug-toolbar
* Добавлены приложения:

  - filebrowser
  - dbmail
  - tinymce

1.3.6b - 2016-12-06
-------------------

* Добавленна новая команда load_summit_ankets_photos для выгрузки фотографий участников саммита.

1.3.2f - 2016-12-05
-------------------

* Проведен рефакторинг кода js
* Код переведен на использование jquery
* Поправлен datepicker
* cropper берется из bower

1.3.5b - 2016-12-02
-------------------

* В экспорт анкет добавленны поля id и user__middle_name.

1.3.4b - 2016-12-01
-------------------

* После логина переадресация идет на страницу Базы Данных вместо Событий.

1.3.3b - 2016-12-01
-------------------

* Для каждой отправки билета он генерируется непосредственно при отправке
* На странице саммита ссылки на саммиты выводятся от позднего к ранним.

1.3.1b - 2016-12-01
-------------------

* Исправлено обновление уведомления о дне рождения при изменении даты рождения пользователя.

1.3.1f - 2016-12-01
-------------------

* Исправлено  проблему с редактированием изображений